{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/media/darcdev/Archivos/Usuario/1-ESTUDIO/UNIVERSIDAD/V SEMESTRE/INGENIERIA DE SOFTWARE I/Proyecto/implementaci\\xF3n/frontend/components/Agents.js\";\nimport { useEffect, useState } from \"react\";\nimport Agent from \"./Agent\";\nimport axios from \"axios\";\nimport getConfig from \"next/config\";\nconst {\n  publicRuntimeConfig: publicConfig\n} = getConfig();\nexport default function Agents({\n  socket,\n  mtToken\n}) {\n  const {\n    0: agents,\n    1: setAgents\n  } = useState([]);\n  useEffect(() => {\n    async function fetchAgents() {\n      const {\n        data: savedAgents\n      } = await axios.get(`${publicConfig.api_url}/api/agents/1`);\n      setAgents(agents => [...savedAgents]);\n    }\n\n    fetchAgents();\n  }, []);\n  useEffect(() => {\n    socket.on(\"agent/connected\", payload => {\n      if (payload.token !== mtToken) return;\n      const {\n        uuid\n      } = payload;\n      const existAgent = agents.find(agent => agent.uuid === uuid);\n      console.log(existAgent);\n\n      if (!existAgent) {\n        console.log(\"entre\");\n        setAgents(agents => [payload.agent, ...agents]);\n      }\n    });\n  }, [socket]);\n\n  const removeAgent = uuid => {\n    setAgents(agents => [...agents.filter(agent => {\n      return agent.uuid !== uuid;\n    })]);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-5 gap-x-2 grid-flow-row auto-rows-max \",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-span-5\",\n        children: [agents.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-14 md:p-20 w-full flex flex-col items-center justify-center\\t\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            alt: \"icon disconnected\",\n            className: \"w-16 md:w-18\",\n            src: \"https://img.icons8.com/fluent/96/000000/wi-fi-disconnected.png\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 48,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-center mt-6 font-bold\\ttext-lg\",\n            children: \"No hay agentes conectados\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 53,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-center mt-6 font-bold\\ttext-lg\\t\",\n            children: \"Envie Metricas desde un dispositivo electronico\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 13\n        }, this), agents.length !== 0 && agents.map(agent => {\n          console.log(\"agente ..\", agent);\n          return /*#__PURE__*/_jsxDEV(Agent, {\n            mtToken: mtToken,\n            uuid: agent.uuid,\n            socket: socket,\n            removeAgent: removeAgent\n          }, agent.uuid, false, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 17\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}","map":{"version":3,"sources":["/media/darcdev/Archivos/Usuario/1-ESTUDIO/UNIVERSIDAD/V SEMESTRE/INGENIERIA DE SOFTWARE I/Proyecto/implementaciÃ³n/frontend/components/Agents.js"],"names":["useEffect","useState","Agent","axios","getConfig","publicRuntimeConfig","publicConfig","Agents","socket","mtToken","agents","setAgents","fetchAgents","data","savedAgents","get","api_url","on","payload","token","uuid","existAgent","find","agent","console","log","removeAgent","filter","length","map"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport Agent from \"./Agent\";\nimport axios from \"axios\";\nimport getConfig from \"next/config\";\n\nconst { publicRuntimeConfig: publicConfig } = getConfig();\n\nexport default function Agents({ socket, mtToken }) {\n  const [agents, setAgents] = useState([]);\n\n  useEffect(() => {\n    async function fetchAgents() {\n      const { data: savedAgents } = await axios.get(\n        `${publicConfig.api_url}/api/agents/1`\n      );\n      setAgents((agents) => [...savedAgents]);\n    }\n\n    fetchAgents();\n  }, []);\n\n  useEffect(() => {\n    socket.on(\"agent/connected\", (payload) => {\n      if (payload.token !== mtToken) return;\n      const { uuid } = payload;\n      const existAgent = agents.find((agent) => agent.uuid === uuid);\n      console.log(existAgent);\n      if (!existAgent) {\n        console.log(\"entre\");\n        setAgents((agents) => [payload.agent, ...agents]);\n      }\n    });\n  }, [socket]);\n\n  const removeAgent = (uuid) => {\n    setAgents((agents) => [\n      ...agents.filter((agent) => {\n        return agent.uuid !== uuid;\n      }),\n    ]);\n  };\n  return (\n    <>\n      <div className=\"grid grid-cols-5 gap-x-2 grid-flow-row auto-rows-max \">\n        <div className=\"col-span-5\">\n          {agents.length === 0 && (\n            <div className=\"p-14 md:p-20 w-full flex flex-col items-center justify-center\t\">\n              <img\n                alt=\"icon disconnected\"\n                className=\"w-16 md:w-18\"\n                src=\"https://img.icons8.com/fluent/96/000000/wi-fi-disconnected.png\"\n              />\n              <p className=\"text-center mt-6 font-bold\ttext-lg\">\n                No hay agentes conectados\n              </p>\n              <p className=\"text-center mt-6 font-bold\ttext-lg\t\">\n                Envie Metricas desde un dispositivo electronico\n              </p>\n            </div>\n          )}\n          {agents.length !== 0 &&\n            agents.map((agent) => {\n              console.log(\"agente ..\", agent);\n              return (\n                <Agent\n                  mtToken={mtToken}\n                  key={agent.uuid}\n                  uuid={agent.uuid}\n                  socket={socket}\n                  removeAgent={removeAgent}\n                />\n              );\n            })}\n        </div>\n      </div>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}