{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/media/darcdev/Archivos/Usuario/1-ESTUDIO/UNIVERSIDAD/V SEMESTRE/INGENIERIA DE SOFTWARE I/Proyecto/implementaci\\xF3n/frontend/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"/media/darcdev/Archivos/Usuario/1-ESTUDIO/UNIVERSIDAD/V SEMESTRE/INGENIERIA DE SOFTWARE I/Proyecto/implementaci\\xF3n/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"/media/darcdev/Archivos/Usuario/1-ESTUDIO/UNIVERSIDAD/V SEMESTRE/INGENIERIA DE SOFTWARE I/Proyecto/implementaci\\xF3n/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { useEffect, useState } from \"react\";\nimport Agent from \"./Agent\";\nimport axios from \"axios\";\nimport getConfig from \"next/config\";\n\nvar _getConfig = getConfig(),\n    publicConfig = _getConfig.publicRuntimeConfig;\n\nexport default function Agents(_ref) {\n  var socket = _ref.socket,\n      mtToken = _ref.mtToken;\n\n  var _useState = useState([]),\n      agents = _useState[0],\n      setAgents = _useState[1];\n\n  useEffect(function () {\n    function fetchAgents() {\n      return _fetchAgents.apply(this, arguments);\n    }\n\n    function _fetchAgents() {\n      _fetchAgents = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _yield$axios$get, savedAgents;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return axios.get(\"\".concat(publicConfig.api_url, \"/api/agents/1\"));\n\n              case 2:\n                _yield$axios$get = _context.sent;\n                savedAgents = _yield$axios$get.data;\n                setAgents(function (agents) {\n                  return _toConsumableArray(savedAgents);\n                });\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return _fetchAgents.apply(this, arguments);\n    }\n\n    fetchAgents();\n  }, []);\n  useEffect(function () {\n    socket.on(\"agent/connected\", function (payload) {\n      if (payload.token !== mtToken) return;\n      var uuid = payload.uuid;\n      var existAgent = agents.find(function (agent) {\n        return agent.uuid === uuid;\n      });\n\n      if (!existAgent) {\n        setAgents(function (agents) {\n          return [payload.agent].concat(_toConsumableArray(agents));\n        });\n      }\n    });\n  }, [socket]);\n\n  var removeAgent = function removeAgent(uuid) {\n    setAgents(function (agents) {\n      return _toConsumableArray(agents.filter(function (agent) {\n        return agent.uuid !== uuid;\n      }));\n    });\n  };\n\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: /*#__PURE__*/_jsx(\"div\", {\n      className: \"grid grid-cols-5 gap-x-2 grid-flow-row auto-rows-max \",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"col-span-5\",\n        children: [agents.length === 0 && /*#__PURE__*/_jsxs(\"div\", {\n          className: \"p-14 md:p-20 w-full flex flex-col items-center justify-center\\t\",\n          children: [/*#__PURE__*/_jsx(\"img\", {\n            alt: \"icon disconnected\",\n            className: \"w-16 md:w-18\",\n            src: \"https://img.icons8.com/fluent/96/000000/wi-fi-disconnected.png\"\n          }), /*#__PURE__*/_jsx(\"p\", {\n            className: \"text-center mt-6 font-bold\\ttext-lg\",\n            children: \"No hay agentes conectados\"\n          }), /*#__PURE__*/_jsx(\"p\", {\n            className: \"text-center mt-6 font-bold\\ttext-lg\\t\",\n            children: \"Envie Metricas desde un dispositivo electronico\"\n          })]\n        }), agents.length !== 0 && agents.map(function (agent) {\n          console.log(\"agente ..\", agent);\n          return /*#__PURE__*/_jsx(Agent, {\n            mtToken: mtToken,\n            uuid: agent.uuid,\n            socket: socket,\n            removeAgent: removeAgent\n          }, agent.uuid);\n        })]\n      })\n    })\n  });\n}","map":null,"metadata":{},"sourceType":"module"}